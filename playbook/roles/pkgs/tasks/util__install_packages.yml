---
- name: register packages
  vars:
    excluded_packages: []
  tags: ['maintenace', 'pkg_maintenace']
  block:

    - name: "register packages {{ package_list | join(' ') | truncate(15) }}"
      tags: ['package']
      set_fact:
        registered_packages: "{{ registered_packages + package_list }}"
        excluded_packages: "{{ excluded_packages + exclude_list }}"
      vars:
        exclude_list: "{{ [exclude] if exclude is string else exclude | flatten }}"
        package_list: "{{ [packages] if packages is string else packages | flatten }}"
